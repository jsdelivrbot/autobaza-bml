!function(){"use strict";function o(){console.log("[abbml] Checking authentication"),gapi.auth.authorize({client_id:u,scope:c,immediate:!0},e)}function e(o){console.log("[abbml] Auth result: %o",o),o&&!o.error?t():(console.log("[abbml] Attempt OAuth2"),gapi.auth.authorize({client_id:u,scope:c,immediate:!1},e))}function t(){console.log("[abbml] Load GAPI YouTube"),gapi.client.load("youtube","v3",function(){i()})}function i(){console.log("[abbml] GAPI YouTube successfully loaded"),l()}function l(){console.log('[abbml] Retrieve "My Garage" playlist');var o=gapi.client.youtube.playlists.list({part:"snippet",mine:!0});o.execute(function(o){var e=o.result;console.log("[abbml] Retrieval result: %o",e),e?(jQuery.each(e.items,function(o,e){"My Garage"===e.snippet.title&&(p=e.id)}),p?a():n()):n()})}function n(){console.log('[abbml] Create "My Garage" playlist');var o=gapi.client.youtube.playlists.insert({part:"snippet,status",resource:{snippet:{title:"My Garage",description:"A private playlist created from Autobaza Radio"},status:{privacyStatus:"private"}}});o.execute(function(o){var e=o.result;console.log("[abbml] Creation result: %o",e),e?(p=e.id,console.log(e),a()):alert("Could not create playlist")})}function a(){console.log("[abbml] Search video");var o=window.frames[0].window.md.innerHTML;console.log("[abbml] Query string:",o);var e=gapi.client.youtube.search.list({q:o,part:"snippet"});e.execute(function(o){var e=o.result;console.log("[abbml] Search results: %o",e),r(e.items[0].id.videoId)})}function r(o){console.log("[abbml] Add video to playlist");var e={videoId:o,kind:"youtube#video"},t=gapi.client.youtube.playlistItems.insert({part:"snippet",resource:{snippet:{playlistId:p,resourceId:e}}});t.execute(function(o){var e=o.result;console.log("[abbml] Addition result: %o",e)})}var s="0.1",u="526967893145-n2me97upn32sd4ohpg11hh9949mr9chq.apps.googleusercontent.com",c=["https://www.googleapis.com/auth/youtube"],p;!function(o){for(var e,t,i={},l=function(){},n="memory".split(","),a="assert,clear,count,debug,dir,dirxml,error,exception,group,groupCollapsed,groupEnd,info,log,markTimeline,profile,profiles,profileEnd,show,table,time,timeEnd,timeline,timelineEnd,timeStamp,trace,warn".split(",");e=n.pop();)o[e]=o[e]||i;for(;t=a.pop();)o[t]=o[t]||l}(window.console=window.console||{}),window.googleApiClientReady=function(){return console.log("[abbml] Autobaza Bookmarklet",s),-1===window.location.href.indexOf("autobazaradio.ro")?void alert("This only works on Autobaza Radio!"):void gapi.auth.init(function(){window.setTimeout(o,1)})}}();