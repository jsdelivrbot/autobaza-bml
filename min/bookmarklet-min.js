!function(){"use strict";function e(){console.log("[abbml] Checking authentication"),gapi.auth.authorize({client_id:u,scope:c,immediate:!0},o)}function o(e){console.log("[abbml] Auth result: %o",e),e&&!e.error?t():(console.log("[abbml] Attempt OAuth2"),gapi.auth.authorize({client_id:u,scope:c,immediate:!1},o))}function t(){console.log("[abbml] Load GAPI YouTube"),gapi.client.load("youtube","v3",function(){i()})}function i(){console.log("[abbml] GAPI YouTube successfully loaded"),l()}function l(){console.log('[abbml] Retrieve "My Garage" playlist');var e=gapi.client.youtube.playlists.list({part:"snippet",mine:!0});e.execute(function(e){var o=e.result;console.log("[abbml] Retrieval result: %o",o),o?(jQuery.each(o.items,function(e,o){"My Garage"===o.snippet.title&&(p=o.id)}),p?n():a()):a()})}function a(){console.log('[abbml] Create "My Garage" playlist');var e=gapi.client.youtube.playlists.insert({part:"snippet,status",resource:{snippet:{title:"My Garage",description:"A private playlist created from Autobaza Radio"},status:{privacyStatus:"private"}}});e.execute(function(e){var o=e.result;console.log("[abbml] Creation result: %o",o),o?(p=o.id,console.log(o),n()):alert("Could not create playlist")})}function n(){console.log("[abbml] Search video");var e=window.frames[0].window.md.innerHTML;console.log("[abbml] Query string:",e);var o=gapi.client.youtube.search.list({q:e,part:"snippet"});o.execute(function(e){var o=e.result;console.log("[abbml] Search results: %o",o),r(o.items[0].id.videoId)})}function r(e){console.log("[abbml] Add video to playlist");var o={videoId:e,kind:"youtube#video"},t=gapi.client.youtube.playlistItems.insert({part:"snippet",resource:{snippet:{playlistId:p,resourceId:o}}});t.execute(function(e){var o=e.result;console.log("[abbml] Addition result: %o",o)})}var s="0.1",u="526967893145-n2me97upn32sd4ohpg11hh9949mr9chq.apps.googleusercontent.com",c=["https://www.googleapis.com/auth/youtube"],p;!function(e){for(var o,t,i={},l=function(){},a="memory".split(","),n="assert,clear,count,debug,dir,dirxml,error,exception,group,groupCollapsed,groupEnd,info,log,markTimeline,profile,profiles,profileEnd,show,table,time,timeEnd,timeline,timelineEnd,timeStamp,trace,warn".split(",");o=a.pop();)e[o]=e[o]||i;for(;t=n.pop();)e[t]=e[t]||l}(this.console=this.console||{}),window.googleApiClientReady=function(){return console.log("[abbml] Autobaza Bookmarklet",s),-1===window.location.href.indexOf("autobazaradio.ro")?void alert("This only works on Autobaza Radio!"):void gapi.auth.init(function(){window.setTimeout(e,1)})}}();